# CDMA技术基本原理及应用

课程的考核论文。

理解扩频技术的价值需要对无线信道的特性有一定的认识。从效果看，扩频类似数字通信的调频。不管是数字还是调频，带宽利用率都不高。然而，调频实现了资源转换，数字实现了抽象和规范化，是实际应用中的有效特性。扩频在近几代通信技术中均有应用。

​CDMA(code division multiple access)技术即码分多址通信技术，其利用码域的正交性实现多址接入，技术的关键点在于找到具有良好相关特性的码组。

## CDMA基本原理

### 两路正交复用

​CDMA技术核心思想可由常见的两路正交复用给出。

​将两路待传输的信号分别与正弦和余弦载波相乘，接收端在与相应载波相乘后低通滤波得到解调信号。两路信号占用了相同的频谱和时隙，利用正弦和余弦函数的正交性实现双路复用。这过程也可以从频谱搬移角度理解，乘正余弦波即为与冲激信号卷积，即线性搬移。正弦波在向正负频搬移的同时会分别向顺逆时钟方向旋转90°，与余弦波的直接搬移相消。

$$
\begin{align}
s(t)&=g_1(t)cos\omega_ct+g_2tsin\omega_ct\\
s(t)cos\omega_ct&=\frac12g_1(t)(1+cos2\omega_ct)+\frac12g_2(t)sin2\omega_ct\xrightarrow{LPF}\frac12g_1(t)\\
s(t)sin\omega_ct&=\frac12g_1(t)sin2\omega_ct+\frac12g_2(t)(1-cos2\omega_ct)\xrightarrow{LPF}\frac12g_2(t)
\end{align}
$$

### 多用户系统

​假设CDMA通信系统内有k个用户同时通信，则每个用户会在载波调制后，再与地址码相乘，作二次调制。接收信号先与相同且同步的地址码相乘，再与载波相乘完成解调。实际系统中常合并为一次调制。

​理想的地址码码组应具有如下特性：

$$
R_{k,i}(\tau)=\begin{cases}
\int_0^Tc_k(t-\tau)c_i(t)dt=T&k=i\text{ and }\tau=0\\
\int_0^Tc_k(t-\tau)c_i(t)dt << T&k\neq i\text{ or }\tau \neq0
\end{cases}
$$

​即**自相关函数为冲激函数，互相关函数恒为0**。**互相关特性决定用户间干扰大小，自相关特性则为系统提供了同步和抗多径的能力**。

### 非同步CDMA

​在理想情况下，所有用户的信号同时到达，或各用户的时延均可知，此时正交码组可作为CDMA的码组，不同用户之间完全没有干扰。然而**实际无线信道存在多径、时变等特性，接收的多用户信号不同步，此时正交码组会产生用户间干扰(MAI)**。在不同相对时延下仍然正交，即具有理想互相关特性的码组尚未找到。因此，实际无线CDMA系统会利用码组的自相关特性来克服多径效应，以弥补互相关特性不够理想的问题，实现在用户间不同步情况下的码分多址接入。

​非同步CDMA的码组之间存在较小的互相关函数和较小的自相关函数，经过多径传输后，产生一较小的干扰。通过调节扩频码长度和用户数，可将干扰控制在噪声水平，实现有效传输。

​非同步CDMA的另一重要优点在于可以**高效地利用信道的闲置资源**。对于移动通信网络和使用了话音激活技术的电话网络，用户数和通信量均会**快速随机波动**。假如系统采用TDMA, FDMA或同步CDMA，系统的频段，时隙和码组相对固定，为保证系统能同时支撑足够多的用户，需预先分配一定的冗余资源。实际通信时，系统内将有大量的空闲资源，若要利用这些资源，需要根据通信强度进行软硬件调节，难以实现。对于非同步CDMA系统，当用户停止发送，对其他用户的干扰便消失，系统总体的信干比得到提升。即不发送信息的用户会直接降低传输误码率，不需要额外调节。对于具有纠错重传机制的网络，误码率的变化可以转化为通信速率的变化。同时若有新用户加入系统，只需要分配新的码片，并不需要调整已分配的资源。这使得非同步CDMA技术具有高度的灵活性，可以适应通信量和用户数的快速变化。

​CDMA技术的一个重要问题是远近效应问题。由于用户间并非完全正交而是存在少量干扰，距离较近的用户所受衰减较小，会在接收端产生大得多的干扰，因此需要根据用户的距离进行功率控制，在移动通信环境下有一定的实现难度。

### CDMA技术的扩频特性

​作为扩频通信技术的一个实例，CDMA具有扩频通信的许多优点，除上文提及的抗多径和同步能力外，CDMA还具有良好的保密性和抗干扰能力，接收机需要知道扩频码才可解调，同时窄带干扰和阻塞干扰均只有一小部分功率会形成干扰。随机的频率选择性衰落也会由于扩频通信极宽的频谱而趋于稳定。由于CDMA的用户数易于调节，其还可实现蜂窝网络中的软切换技术，当用户位于小区边缘时，用户可同时与多个基站通信，避免了小区切换时信号功率的骤变问题。

​CDMA技术可用的码组包括m序列，沃尔什正交函数集码组等。m序列具有理想的自相关特性，互相关特性不够理想，但存在上界，在其他领域也有广泛应用。沃尔什正交函数集为完备正交集，具有较好的相关特性。另外还有gold序列，M序列，以及基于信道特性动态分析所需码长的码组的机器学习算法生成序列等。

### m序列

​m序列是最长线性反馈移位寄存器序列的简称。是由带线性反馈的移存器产生的最长序列。其对应的反馈系数应为本原多项式。由于m序列遍历了寄存器除全0外的所有状态，其输出的0和1数目接近一致。同时，可证明序列的游程服从指数分布，序列的自相关函数为冲激函数。这些性质使得m序列具有接近随机序列的特性，称为伪随机序列(Pseudo Noise)，适合用于扩频通信。其他PN序列还包括M序列、二次剩余序列、霍尔序列、双素数序列等。

### 沃尔什函数

一种定义方式：

$$WAL(k, t)=\prod\limits_{r=0}^{p-1} sgn[cos(2^{r}k_r\pi t)],\quad k\in N,\quad k=\sum\limits_{r=0}^{p-1}k_r2^r$$

沃尔什函数集为[完备正交集](../../%E6%95%B0%E5%AD%A6/%E4%BF%A1%E5%8F%B7%E5%88%86%E6%9E%90/%E4%BF%A1%E5%8F%B7%E7%9F%A2%E9%87%8F%E7%A9%BA%E9%97%B4%E5%88%86%E6%9E%90.md)，可用来分解任意信号。由此公式可得到任意数量的正交码组。

### 扩频序列的码字同步

​在扩频通信系统中，接收端需要产生一个和发送端同码同相的本地扩频码。同步一般分为两步，捕获和跟踪。

​捕获状态下，接收机的伪码产生器不断移动相位，直到寻找到足够大的接收信号，此时收发端伪码产生器实现同步。为提高搜索速度，还可同时产生不同相位的伪码，选择接受信号最强的相位作为接收机的码字相位。实际通信时还可在序列前加入一段较短的同步码组以缩短搜索时间。

​跟踪状态下，类似码字闭环同步中的超前滞后门方法，系统可产生超前和滞后半个码片时间的两伪码序列，在理想同步状态下，两序列的接收信号强度应当一致，不同步时，信号的强度差可用于调节伪码发生器的频率，进而实现相位锁定。为使两序列的接收信号经历电路特性完全一致，还可采用时分方式进行相位锁定。

## CDMA技术应用

​CDMA技术在第二代移动通信系统开始得到广泛应用，并且直到目前依然具有重要作用。

### RAKE接收机

​RAKE接收机应用了分集接收技术，使信号相干叠加，噪声非相干叠加。对于多径信道，可以利用CDMA码组的自相关特性提取不同时延信号，再合并解调，更大程度地利用了接收信号的功率。

### GPS

​卫星间的码分复用简化了硬件设计，同时提高了保密性。

### IS-95

​IS-95属于2G系统，为第一代基于CDMA技术的数字蜂窝网络，为CDMA后续应用提供了基础。采用三层结构，第一层对应网络物理层，第二层对应媒体接入层，第三层对应话务处理。前向链路采用QPSK调制，每个小区由64个沃尔什码组多址接入，利用伪随机码作为导频。反向链路使用OQPSK调制，并采用相同方式扩频。系统采用GPS信号进行同步，属于同步CDMA系统。

​移动台在导频段遍历所有码组做互相关运算寻找附近的基站。网络采用分组交换，卷积编码。采用动态功率控制，移动台会在通信时发送信号强度指示，网络依此控制通信功率。

​在向3G的过渡阶段提出了IS-95B，允许一个用户使用多个码片以提高通信速率，且定义了硬切换流程。

### CDMA2000

​基于IS-95系统演进而来的3G通信系统。引入自适应速率及多载波等技术，硬件变化较小，升级成本较低。

### W-CDMA

​由GSM升级而来的宽带CDMA系统，集合了多项CDMA提议，获得广泛应用。信道带宽为5MHz，为CDMA2000的4倍，需要完全更换硬件。

### TD-SCDMA

​时分同步码分复用系统，为中国提出的一项3G标准。信道带宽为1.6MHz，采用了智能天线，空间滤波，联合检测等技术。TDD的双工模式使得上下行链路带宽可以灵活分配，在非对称流量传输情况具有更好的性能。

## 参考资料

[Code-division multiple access - Wikipedia](https://en.wikipedia.org/wiki/Code-division_multiple_access)

Don Torrieri. Principles of Spread-Spectrum Communication Systems[M]. Springer Science+Business Media, LLC 2011

郑君里，应启珩，杨为理. 信号与系统[M]. 第三版。 北京：高等教育出版社，2011.3：383-386

田日才，迟永刚. 扩频通信[M]. 第二版。 北京：清华大学出版社，2014

樊昌信，曹丽娜. 通信原理[M]. 第7版。 北京：国防工业出版社，2020.1：379-409

Theodore S.Rappaport. 无线通信原理与应用[M]. 第二版。周文安等译。北京：电子工业出版社，2018.1：16-26
